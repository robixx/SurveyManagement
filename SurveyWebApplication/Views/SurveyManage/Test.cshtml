@model List<SurveyWebApplication.Models.Question>
@{
    ViewBag.Title = "SurveyQuestion";
    int k = 1;
}

<style>
    .custom-accordion-button {
        //-bs-accordion-btn-padding-x: 0.75rem !important;
        vertical-align: middle !important;
    }

    a {
        text-decoration: none;
    }

    .custom-accordion-button {
        background-color: #e7e9e7 !important;
    }

    .radiobutton {
        width: 25px !important;
        height: 25px !important;
    }

    .checkbox {
        width: 25px !important;
        height: 25px !important;
    }

    .custbtn {
        padding: 0px 0px 0px 0px !important;
    }

    table {
        border-collapse: collapse;
        width: 100%;
        margin-top: 20px;
    }

    th, td {
        border: 1px solid #dddddd;
        padding: 8px;
        text-align: left;
    }

    th {
        background-color: #f2f2f2;
    }

    tr:nth-child(even) {
        background-color: #f9f9f9;
    }
</style>
<div class="container-fluid mb-5 bg-light ">
    <div class="jumbotron ">
        <form id="Survey" method="post">
            <div class="row">
                <div class="col-md-6 pb-3">
                    <div class="row">
                        <div class="col-md-2">
                            <label for="email">Set Name</label>
                        </div>
                        <div class="col-md-5">
                            <input id="setName" class="easyui-combobox " style="width: 275px; height: 35px;"  data-options="valueField:'SetId',textField:'SetName',method:'Get', url:'SetNameList/SurveyManage'">

                        </div>
                        <div class="col-md-1"></div>
                        <div class="col-md-2 mt-1">
                            <button class="easyui-linkbutton c1" type="submit" id="SetSearch">Search</button>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="">
                        <h3>Survey Report Show</h3>
                    </div>
                </div>

            </div>


            @for (int i = 0; i < Model.Count; i++)
            {

                <div class="accordion custom-accordion-button bg-light" id="accordionExample-@i" style=" ">
                    <div class="accordion-item ">
                        <h2 class="accordion-header">
                            <a class="accordion-button .custom-accordion-button" data-bs-toggle="collapse" data-bs-target="#collapseOne-@i" aria-expanded="true" aria-controls="collapseOne-@i">
                                <label class="textbox-label textbox-label-top titleName " id="@Model[i].QuestionId" style="padding:1px; font-size:20px;">@k.  @Model[i].QuestionTitle</label>
                                <input id="hiddenQtyId" name="@Model[i].OptionTypeId" value="@Model[i].OptionTypeId" type="hidden" class="OptionTypeId">
                                <input id="hiddenQId" value="@Model[i].QuestionId" name="@Model[i].QuestionId " type="hidden" class="QuestionId">

                            </a>

                        </h2>
                        <div id="collapseOne-@i" class="collapse" data-bs-parent="#accordionExample-@i">
                            <div class="accordion-body">
                                @for (int j = 0; j < Model[i].OptionList.Count; j++)
                                {
                                    if (@Model[i].OptionList[j].OptionTypeId == 1)
                                    {
                                        <div class="row">

                                            <div class="col-md-1">

                                            </div>
                                            <div class="col-md-8">

                                                <input type="radio" name="questionResponses[@i].check" id="CheckOptionId" value="@Model[i].OptionList[j].OptionId" class="easyui-radiobutton optId" disabled>
                                                <label class="textbox-label " style="width:80%; font-size:20px;">@Model[i].OptionList[j].OptionName</label>
                                                <button id="btnResponseid[@i]" class="btn btn-primary custbtn" type="button" onclick="loadOptionDetails(@Model[i].OptionList[j].OptionId)">
                                                    <input type="hidden" name="questionResponses[@i]" id="CountId" value="@Model[i].OptionList[j].OptionId">
                                                    <span class="rounded-pill badge  ">@Model[i].OptionList[j].AnsCount</span>
                                                </button>
                                            </div>
                                            <div class="col-md-3"></div>
                                        </div>
                                    }
                                    else if (@Model[i].OptionList[j].OptionTypeId == 2)
                                    {
                                        <div class="row">

                                            <div class="col-md-1">

                                            </div>
                                            <div class="col-md-8">

                                                <input type="checkbox" name="questionResponses[@i].check" id="CheckOptionId" value="@Model[i].OptionList[j].OptionId" class="easyui-checkbox optId" disabled="disabled">
                                                <label class="textbox-label " style="width: 80%; font-size: 20px;">@Model[i].OptionList[j].OptionName</label>
                                                <button id="btnResponseid" class="btn btn-info custbtn" type="button" onclick="loadOptionDetails(@Model[i].OptionList[j].OptionId)">
                                                    <input type="hidden" name="questionResponses[@i]" id="CountId[@i]" value="@Model[i].OptionList[j].OptionId">
                                                    <span class="rounded-pill badge ">@Model[i].OptionList[j].AnsCount</span>
                                                </button>
                                            </div>
                                            <div class="col-md-3"></div>
                                        </div>
                                    }
                                    else if (@Model[i].OptionList[j].OptionTypeId == 3)
                                    {
                                        <div class="row ">
                                            <div class="col-md-1"></div>
                                            <div class="col-md-8">
                                                <input class=" form-control  textField" id="textNode[@i]" name="questionResponses[@i].TextField" style="width: 100%; height: 60px; ">
                                            </div>
                                        </div>
                                    }

                                }
                            </div>
                        </div>
                    </div>
                </div>

                                k++;
            }
            @*<div class="row mt-2 text-center">
                <div class="col-md-4"></div>
                <div class="col-md-4">
                    <button class="easyui-linkbutton c1" type="submit" style="width:100%; " id="btnSurvey"><h2>Survey Save</h2></button>

                </div>
                <div class="col-md-4"></div>
            </div>*@

        </form>
        <div class="row">
            <div class="line text-center">
                <div class="lineL"></div>
                <div class="" style="display:inline-block;">Survey Report </div>
                <div class="lineR"></div>
            </div>
        </div>

    </div>


    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Customer List</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                    <div id="tableContainer"></div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    @*<button type="button" class="btn btn-primary">Save changes</button>*@
                </div>
            </div>
        </div>
    </div>







</div>







<script>

    $('#setName').combobox({
        prompt: 'Select an Set',
        valueField: 'SetId',
        textField: 'SetName',
        url: 'SetNameList/SurveyManage',
        onLoadSuccess: function (data) {
            console.log(data);
        }
    });

    function createTable(containerId, dataArray)
    {
        debugger
        var container = document.getElementById(containerId);
        var table = document.createElement('table');
        var thead = document.createElement('thead');
        var tbody = document.createElement('tbody');

        // Create header row
        var headerRow = document.createElement('tr');
        for (var key in dataArray[0]) {
            var th = document.createElement('th');
            th.textContent = key;
            headerRow.appendChild(th);
        }
        thead.appendChild(headerRow);
        table.appendChild(thead);

        // Create data rows
        dataArray.forEach(function (item) {
            var row = document.createElement('tr');
            for (var key in item) {
                var td = document.createElement('td');
                td.textContent = item[key];
                row.appendChild(td);
            }
            tbody.appendChild(row);
        });

        table.appendChild(tbody);
        container.appendChild(table);


    }


    function loadOptionDetails(optId) {
        debugger;
        $.ajax({
            url: "ModalData/" + optId,
            type: 'GET',
            success: function (result) {
                var modalDataElement = $('#tableContainer');
                modalDataElement.empty();
                debugger;
                if (result.length > 0)
                {
                    debugger;
                    createTable('tableContainer', result);
                   
                } else {
                    modalDataElement.append('<div class="text-center"> Data Not Found </div> ');
                }



                $('#myModal').modal('show');
            },
            error: function () {
                debugger;
            }
        });



    }

    $('#SetSearch').click(function (e) {
        e.preventDefault();
        debugger
        var dvalue =$('#setName').val();
        window.location.href = '@Url.Action("Test", "SurveyManage")?dvalue=' + dvalue;

    });
   

</script>